---
title: Pages (CMS)
description: CMS-like page management with block-based editing and custom domains
icon: i-lucide-file-text
---

# Pages (CMS)

::alert{type="info"}
**Status**: Stable ✅
::

The Pages feature provides a CMS-like page management system with page types, block-based editing, tree organization, and custom domain support.

## Enable

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  modules: ['@fyit/crouton'],

  crouton: {
    pages: true,
    editor: true  // Required for rich text blocks
  }
})
```

## Key Features

- **Page Types**: Regular pages, app-specific pages (booking calendar, product list)
- **Block Editor**: Hero sections, feature grids, CTAs, cards, rich text
- **Tree Organization**: Hierarchical page ordering with drag-and-drop
- **Custom Domains**: Automatic team resolution from custom domains
- **Public Routes**: `/[team]/[slug]` for public pages

## URL Structure

| Route | Purpose |
|-------|---------|
| `/[team]/[slug]` | Public page display |
| `/[team]/` | Homepage (empty slug) |
| `/admin/[team]/pages` | Admin page management |

## Page Types

Apps can register custom page types that appear in the page type selector.

### Built-in Types

- `core:regular` - Standard rich text page

### Registering Custom Types

```typescript
// app.config.ts
export default defineAppConfig({
  croutonApps: {
    bookings: {
      id: 'bookings',
      name: 'Bookings',
      pageTypes: [
        {
          id: 'calendar',
          name: 'Booking Calendar',
          component: 'CroutonBookingsCalendar',
          icon: 'i-lucide-calendar',
          category: 'customer',
          description: 'Interactive calendar for bookings'
        }
      ]
    }
  }
})
```

### Using Page Types

```typescript
const {
  pageTypes,           // All aggregated page types
  pageTypesByApp,      // Grouped by source app
  pageTypesByCategory, // Grouped by category
  getPageType,         // Get by fullId (e.g., 'bookings:calendar')
  hasPageType,         // Check if exists
  getDefaultPageType   // Returns 'core:regular'
} = usePageTypes()
```

## Block Editor

The block-based editor uses TipTap and Nuxt UI page components.

### Block Types

| Block | Component | Purpose |
|-------|-----------|---------|
| `heroBlock` | UPageHero | Title, description, CTA, image |
| `sectionBlock` | UPageSection | Feature grid with icons |
| `ctaBlock` | UPageCTA | Call-to-action banner |
| `cardGridBlock` | UPageGrid + UPageCard | Grid of cards |
| `separatorBlock` | USeparator | Visual divider |
| `richTextBlock` | prose div | Standard text content |

### Using the Editor

```vue
<template>
  <CroutonPagesEditorBlockEditor
    v-model="content"
    placeholder="Type / to insert a block..."
  />
</template>
```

### Block Utilities

```typescript
const {
  parse,              // Parse JSON to blocks
  serialize,          // Serialize blocks to JSON
  detectFormat,       // Detect content format
  createEmpty,        // Create empty doc
  addBlock,           // Add block to content
  removeBlock,        // Remove block by index
  updateBlock,        // Update block attrs
  moveBlock,          // Reorder blocks
  getAvailableBlocks  // Get block menu items
} = usePageBlocks()
```

## Content Format

Content auto-detects format:
- **JSON with `type: 'doc'`** - Renders as blocks
- **HTML string** - Renders as legacy content
- **Empty** - Shows empty state

```typescript
interface PageBlockContent {
  type: 'doc'
  content: PageBlock[]
}

interface PageBlock {
  type: 'heroBlock' | 'sectionBlock' | 'ctaBlock' | 'cardGridBlock' | 'separatorBlock'
  attrs: Record<string, any>
}
```

## Page Schema

```typescript
interface PageRecord {
  id: string
  teamId: string
  title: string
  slug: string
  pageType: string        // 'core:regular' or 'appId:pageTypeId'
  content?: string        // For regular pages (JSON blocks or HTML)
  config?: object         // For app pages (type-specific settings)
  status: 'draft' | 'published' | 'archived'
  visibility: 'public' | 'members' | 'hidden'
  showInNavigation: boolean
  parentId?: string       // For hierarchy
  order: number           // For sorting
  path?: string           // Materialized path
  depth?: number          // Nesting level
}
```

## Custom Domains

The pages package supports custom domain resolution.

### How It Works

```
Custom Domain Request: booking.acme.com/about
    │
    ▼
Domain resolver middleware
    │ looks up 'booking.acme.com' in domain table
    │ finds: organizationId → org with slug 'acme'
    ▼
URL Rewrite: /about → /acme/about
    │
    ▼
Normal routing: [team]/[...slug].vue
```

### Domain Context

```typescript
const {
  isCustomDomain,    // Whether request is from custom domain
  resolvedDomain,    // The custom domain hostname
  resolvedTeamId,    // Team ID from domain lookup
  hideTeamInUrl,     // true on custom domains
  hostname,          // Current hostname
  isAppDomain        // Whether hostname is known app domain
} = useDomainContext()
```

### Configuration

```typescript
runtimeConfig: {
  public: {
    croutonPages: {
      // Domains to skip (not custom domains)
      appDomains: ['myapp.com', 'staging.myapp.com'],
      debug: false
    }
  }
}
```

## Navigation

Build navigation from published pages:

```typescript
const {
  navigation,        // Hierarchical navigation tree
  flatNavigation,    // Flat list of all nav items
  isLoading,         // Loading state
  currentPage,       // Current active page
  isActive,          // Check if nav item is active
  refresh,           // Refresh navigation data
  team               // Current team slug
} = useNavigation()
```

## Components

| Component | Purpose |
|-----------|---------|
| `CroutonPagesRenderer` | Renders page based on type |
| `CroutonPagesRegularContent` | Rich text content display |
| `CroutonPagesBlockContent` | Block-based content display |
| `CroutonPagesEditorBlockEditor` | Block editor |
| `CroutonPagesForm` | Page creation/editing form |

## Admin Page List

```vue
<template>
  <CroutonCollection
    collection="pagesPages"
    layout="tree"
    :columns="['title', 'slug', 'pageType', 'status']"
  />
</template>
```

## Rendering Pages

```vue
<template>
  <CroutonPagesRenderer :page="pageData" />
</template>
```

## API Endpoints

| Endpoint | Method | Purpose |
|----------|--------|---------|
| `/api/teams/[id]/pages` | GET | List published pages (for navigation) |
| `/api/teams/[id]/pages/[slug]` | GET | Get single page by slug |

## Use Cases

- **Marketing sites**: Landing pages, about, contact
- **Documentation**: Knowledge base, help center
- **Portals**: Customer dashboards, member areas
- **Multi-tenant apps**: Team-specific pages with custom domains

## Related

- [Rich Text Editor](/features/rich-text) - Editor integration
- [Collaboration](/features/collaboration) - Real-time editing
- [Package Architecture](/fundamentals/packages#fyi-crouton-pages) - Package details
