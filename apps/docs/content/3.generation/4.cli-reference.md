---
title: CLI Reference
description: Complete reference for all crouton-generate CLI commands and options
icon: i-heroicons-terminal
---

The `@friendlyinternet/nuxt-crouton-cli` package provides a powerful CLI tool for generating complete CRUD collections. This reference covers all available commands, options, and workflows.

## Installation

### Global Installation (Recommended)

```bash
npm install -g @friendlyinternet/nuxt-crouton-cli
```

After global installation, both `crouton` and `crouton-generate` commands are available everywhere:

```bash
crouton --help
# or
crouton-generate --help
```

::callout{icon="i-heroicons-light-bulb" color="blue"}
**Tip:** The `crouton` command is an alias for `crouton-generate`. Both work identically.
::

### Project-Level with npx

```bash
# Use directly without installation
npx @friendlyinternet/nuxt-crouton-cli <command>

# Or add to project devDependencies
pnpm add -D @friendlyinternet/nuxt-crouton-cli
npx crouton-generate <command>
```

## Command Overview

The CLI provides five main commands:

| Command | Purpose | Usage |
|---------|---------|-------|
| `generate` | Generate collections | Single collection or from config file |
| `add` | Add features | Add pre-built features like event tracking |
| `init` | Create example schema | Quick start helper |
| `config` | Use config file | Alternative syntax for config-based generation |
| `rollback` | Remove collections | Single, bulk, or interactive removal |

## Commands

### generate

Generate a new CRUD collection with all necessary files.

#### Basic Syntax

```bash
crouton-generate <layer> <collection> [options]
```

#### Arguments

- `<layer>` - Target layer name (e.g., `shop`, `admin`, `blog`)
- `<collection>` - Collection name in plural form (e.g., `products`, `users`, `posts`)

::callout{icon="i-heroicons-information-circle"}
**Naming convention**: Collection names are lowercased for folder paths. For example, `productOptions` becomes `productoptions/` in the file system. Use kebab-case (e.g., `product-options`) for multi-word collection names.
::

#### Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `-f, --fields-file <path>` | string | - | Path to JSON schema file (required) |
| `-d, --dialect <type>` | pg\|sqlite | sqlite | Database dialect |
| `--auto-relations` | boolean | false | Add relation stubs in comments |
| `--dry-run` | boolean | false | Preview without creating files |
| `--no-translations` | boolean | false | Skip translation field generation |
| `--force` | boolean | false | Overwrite existing files |
| `--no-db` | boolean | false | Skip database table creation |
| `--hierarchy` | boolean | false | Enable hierarchy support (parentId, path, depth, order) |
| `--seed` | boolean | false | Generate seed data file with drizzle-seed |
| `--count <number>` | number | 25 | Number of seed records to generate |
| `-c, --config <path>` | string | - | Use config file instead |

#### Examples

**Basic generation:**
```bash
crouton-generate shop products --fields-file=./schemas/product.json
```

**With options:**
```bash
crouton-generate admin users \
  --fields-file=./schemas/user.json \
  --dialect=pg \
  --force
```

**Preview changes (dry run):**
```bash
crouton-generate blog posts \
  --fields-file=./schemas/post.json \
  --dry-run
```

**Using config file:**
```bash
crouton-generate --config ./crouton.config.js
```

**With hierarchy support:**
```bash
crouton-generate content pages \
  --fields-file=./schemas/page.json \
  --hierarchy
```

#### What Gets Generated

Each `generate` command creates:

```
layers/[layer]/collections/[collection]/
├── app/
│   ├── components/
│   │   ├── Form.vue                   # CRUD form with validation
│   │   ├── List.vue                   # Data table/list
│   │   └── RepeaterItem.vue           # For repeater fields (if needed)
│   └── composables/
│       └── use[Layer][Collection].ts  # Zod schema, columns, defaults (e.g., useShopProducts.ts)
├── server/
│   ├── api/teams/[id]/[collection]/
│   │   ├── index.get.ts               # GET all/by IDs
│   │   ├── index.post.ts              # CREATE
│   │   ├── [id].patch.ts              # UPDATE
│   │   └── [id].delete.ts             # DELETE
│   └── database/
│       ├── queries.ts                 # Query functions
│       ├── schema.ts                  # Drizzle schema
│       └── seed.ts                    # Seed data (with --seed flag)
├── types.ts                            # TypeScript interfaces
└── nuxt.config.ts                     # Layer configuration
```

#### Hierarchy Support

When using the `--hierarchy` flag (or `hierarchy: true` in config), additional files and fields are generated for tree/nested data structures:

**Additional database fields:**
- `parentId` - Reference to parent record (nullable)
- `path` - Materialized path for efficient tree queries
- `depth` - Nesting level (0 for root items)
- `order` - Sort order within siblings

**Additional API endpoints:**
- `[id]/move.patch.ts` - Move item to new parent
- `reorder.patch.ts` - Reorder sibling items

**Additional queries:**
- `getTreeData()` - Fetch hierarchical data
- `updatePosition()` - Update item position
- `reorderSiblings()` - Reorder items at same level

**Zod schema includes:**
```typescript
parentId: z.string().nullable().optional()
```

**Default values include:**
```typescript
parentId: null
```

::callout{icon="i-heroicons-light-bulb" color="blue"}
**Tip:** Hierarchy is ideal for nested categories, organizational structures, page trees, or any parent-child relationships.
::

#### Seed Data Generation

Generate realistic test data alongside your collections using drizzle-seed + Faker.

**CLI usage:**
```bash
# Generate with seed data (25 records by default)
crouton-generate shop products --fields-file=products.json --seed

# Generate with custom record count
crouton-generate shop products --fields-file=products.json --seed --count=100
```

**Config file usage:**
```javascript
// crouton.config.js
export default {
  collections: [
    { name: 'products', fieldsFile: './schemas/products.json', seed: true },           // 25 records
    { name: 'categories', fieldsFile: './schemas/categories.json', seed: { count: 50 } } // custom count
  ],
  seed: {
    defaultCount: 25,          // default for all collections
    defaultTeamId: 'seed-team' // team ID for seeded data
  },
  // ... other config
}
```

**Running seeds:**

After generation, execute the seed file:

```bash
# Run directly
npx tsx ./layers/shop/collections/products/server/database/seed.ts

# Or import in your code
import { seedShopProducts } from './layers/shop/collections/products/server/database/seed'

await seedShopProducts({
  count: 100,
  teamId: 'my-team',
  reset: true  // optionally clear existing data first
})
```

**Field-to-generator mapping:**

The seed generator auto-detects field names and generates appropriate data:

| Field Pattern | Generated Data |
|---------------|----------------|
| `email` | `f.email()` - realistic email addresses |
| `name`, `fullName` | `f.fullName()` - person names |
| `title` | `f.loremIpsum({ sentencesCount: 1 })` |
| `description`, `content` | `f.loremIpsum({ sentencesCount: 3 })` |
| `price`, `amount` | `f.number({ minValue: 1, maxValue: 1000 })` |
| Foreign keys | Placeholder values with dependency comments |

::callout{icon="i-heroicons-light-bulb" color="blue"}
**Tip:** Seed data is great for development, demos, and testing. The generated seed file can be customized after generation.
::

### init

Create an example schema file to help you get started.

#### Syntax

```bash
crouton-generate init [options]
```

#### Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `-o, --output <path>` | string | ./crouton-schema.json | Output path for schema file |

#### Example

```bash
# Create example schema
crouton-generate init

# Custom output path
crouton-generate init --output ./schemas/example.json
```

#### Generated Schema

The `init` command creates a complete example schema showing all field types:

```json
{
  "id": {
    "type": "string",
    "meta": {
      "primaryKey": true
    }
  },
  "name": {
    "type": "string",
    "meta": {
      "required": true,
      "maxLength": 255
    }
  },
  "description": {
    "type": "text"
  },
  "price": {
    "type": "decimal",
    "meta": {
      "precision": 10,
      "scale": 2
    }
  },
  "inStock": {
    "type": "boolean"
  },
  "createdAt": {
    "type": "date"
  }
}
```

::callout{icon="i-heroicons-light-bulb" color="blue"}
**Tip:** After running `init`, edit the generated schema file to match your needs, then use it with `crouton-generate`.
::

### add

Add pre-built features to your existing Nuxt Crouton project.

#### Syntax

```bash
crouton-generate add <feature> [options]
```

#### Arguments

- `<feature>` - Feature to add (currently: `events`)

#### Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `--dry-run` | boolean | false | Preview what will be generated |
| `--force` | boolean | false | Overwrite existing files |

#### Available Features

##### events

Add the crouton-events layer for audit trail tracking. This creates a complete event tracking system that automatically logs all collection mutations (create, update, delete).

```bash
# Add events layer
crouton-generate add events

# Preview what will be created
crouton-generate add events --dry-run

# Overwrite existing files
crouton-generate add events --force
```

#### What Gets Generated

The `add events` command creates:

```
layers/crouton-events/
├── nuxt.config.ts                      # Layer configuration
├── types.ts                            # TypeScript interfaces
└── server/
    ├── database/
    │   ├── schema.ts                   # Drizzle schema for events table
    │   └── queries.ts                  # Query functions (getAll, create, etc.)
    └── api/teams/[id]/crouton-collection-events/
        ├── index.get.ts                # GET all events
        ├── index.post.ts               # CREATE event
        ├── [eventId].patch.ts          # UPDATE event
        └── [eventId].delete.ts         # DELETE event
```

#### Auto-Updated Files

The command also updates:

1. **`nuxt.config.ts`** - Adds `'./layers/crouton-events'` to extends array
2. **`server/database/schema/index.ts`** - Adds schema export

#### Next Steps After Adding Events

```bash
# 1. Run database migration
pnpm drizzle-kit generate
pnpm drizzle-kit migrate

# 2. Install the events tracking package (for auto-tracking)
pnpm add @friendlyinternet/nuxt-crouton-events

# 3. Add to nuxt.config.ts extends
# '@friendlyinternet/nuxt-crouton-events'
```

::callout{icon="i-heroicons-information-circle"}
**Note:** The `add events` command creates the server-side storage layer. To enable automatic event tracking for all collection mutations, also install `@friendlyinternet/nuxt-crouton-events` package. See [Events Package](/features/events) for full documentation.
::

### config

Alternative syntax for generating collections using a configuration file.

#### Syntax

```bash
crouton-generate config [configPath] [options]
```

#### Arguments

- `[configPath]` - Path to config file (auto-detected if not specified)

::callout{icon="i-heroicons-information-circle"}
**Auto-detection:** If no config path is provided, the CLI automatically searches for config files in this order:
1. `crouton.config.js`
2. `crouton.config.js`
3. `crouton.config.cjs`
4. `crouton.config.ts`
::

#### Options

| Option | Type | Description |
|--------|------|-------------|
| `--only <name>` | string | Generate only a specific collection from the config |

#### Examples

```bash
# Auto-detect config file (searches for crouton.config.js/.mjs/.cjs/.ts)
crouton-generate config

# Use specific config file
crouton-generate config ./configs/production.config.mjs

# Generate only a single collection from config
crouton-generate config --only products

# Combine config path with --only flag
crouton-generate config ./crouton.config.js --only pages

# Alternative: Use --config flag with generate command
crouton-generate --config ./crouton.config.js
```

#### Config File Format

See [Configuration File](#configuration-file) section below for complete details.

### rollback

Remove generated collections with various strategies.

#### Single Collection Rollback

Remove a specific collection:

```bash
crouton-generate rollback <layer> <collection> [options]
```

**Arguments:**
- `<layer>` - Layer name containing the collection
- `<collection>` - Collection name to remove

**Options:**
| Option | Description |
|--------|-------------|
| `--dry-run` | Preview what will be removed |
| `--keep-files` | Only clean configs, keep generated files |
| `--force` | Force removal without warnings |

**Example:**
```bash
# Preview removal
crouton-generate rollback shop products --dry-run

# Remove with confirmation
crouton-generate rollback shop products

# Force remove without prompts
crouton-generate rollback shop products --force
```

#### Bulk Rollback

Remove entire layers or multiple collections:

```bash
crouton-generate rollback-bulk [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `--layer <name>` | Remove entire layer with all collections |
| `--config <path>` | Remove collections defined in config file |
| `--dry-run` | Preview what will be removed |
| `--keep-files` | Only clean configs, keep files |
| `--force` | Force removal without warnings |

**Examples:**
```bash
# Remove entire layer
crouton-generate rollback-bulk --layer=shop

# Preview layer removal
crouton-generate rollback-bulk --layer=shop --dry-run

# Remove collections from config file
crouton-generate rollback-bulk --config=./crouton.config.js

# Force bulk removal
crouton-generate rollback-bulk --layer=shop --force
```

#### Interactive Rollback

Use an interactive UI to select what to remove:

```bash
crouton-generate rollback-interactive [options]
```

**Options:**
| Option | Description |
|--------|-------------|
| `--dry-run` | Preview what will be removed |
| `--keep-files` | Only clean configs, keep files |

**Interactive Flow:**

```bash
$ crouton-generate rollback-interactive

═══════════════════════════════════════════════════════════
  INTERACTIVE ROLLBACK
═══════════════════════════════════════════════════════════

Found 3 layers:

  • shop (5 collections)
  • blog (3 collections)
  • admin (2 collections)

? What would you like to rollback?
  ❯ Entire layer (all collections)
    Specific collections
    Cancel

? Select layer:
  ❯ shop (5 collections)
    blog (3 collections)
    admin (2 collections)

? Are you sure you want to remove layer "shop"? (Y/n)
```

::callout{icon="i-heroicons-exclamation-triangle" color="amber"}
**Warning:** Rollback operations are destructive. Always use `--dry-run` first to preview changes. The `rollback` command removes:
- Generated files in `layers/[layer]/collections/[collection]/`
- Schema exports from `server/database/schema/index.ts`
- Collection registrations from `app.config.ts`
- Layer references from root `nuxt.config.ts` (for bulk operations)
::

### install

Check and install required Nuxt modules (mainly for development).

```bash
crouton-generate install
```

This command checks for and installs:
- `@friendlyinternet/nuxt-crouton` (core package)
- Required Drizzle ORM packages
- Other dependencies

## Configuration File

The configuration file provides a declarative way to define all generation settings.

### Basic Structure

```javascript
// crouton.config.js
export default {
  // Path to JSON schema file(s)
  schemaPath: './schemas/product.json',

  // Database dialect
  dialect: 'sqlite',  // or 'pg'

  // Target layers and collections
  targets: [
    {
      layer: 'shop',
      collections: ['products', 'categories']
    }
  ],

  // External connectors (optional)
  connectors: {},

  // Generation flags
  flags: {}
}
```

### Configuration Options

#### schemaPath

**Type:** `string`

Path to your JSON schema file(s). Can be:
- Single file: `'./product-schema.json'`
- Directory: `'./schemas/'` (uses convention `[collection]-schema.json`)

```javascript
export default {
  schemaPath: './schemas/',  // Looks for products-schema.json, etc.
  targets: [
    {
      layer: 'shop',
      collections: ['products', 'categories']  // Uses products-schema.json, categories-schema.json
    }
  ]
}
```

#### dialect

**Type:** `'pg' | 'sqlite'`  
**Default:** `'sqlite'`

Database dialect for generated schemas and queries.

```javascript
export default {
  dialect: 'pg',  // PostgreSQL
  // Or
  dialect: 'sqlite'  // SQLite (default)
}
```

#### targets

**Type:** `Array<{ layer: string, collections: string[] }>`

Defines which collections to generate in which layers.

```javascript
export default {
  targets: [
    {
      layer: 'shop',
      collections: ['products', 'categories', 'orders']
    },
    {
      layer: 'blog',
      collections: ['posts', 'authors']
    }
  ]
}
```

#### connectors

**Type:** `Record<string, ConnectorConfig>`

Configure external connectors for `:referenced` collections (e.g., `:users`, `:teams`).

```javascript
export default {
  connectors: {
    users: {
      type: 'supersaas',      // Connector type
      autoInstall: true,       // Install package automatically
      copyFiles: true,         // Copy connector files to project
      updateAppConfig: true    // Register in app.config.ts
    },
    teams: {
      type: 'supersaas',
      autoInstall: true,
      copyFiles: true,
      updateAppConfig: true
    }
  }
}
```

**Connector Types:**
- `'supersaas'` - SuperSaaS team-based authentication
- `'supabase'` - Supabase auth.users
- `'clerk'` - Clerk authentication

See [External References](#external-references) for more details.

#### flags

**Type:** `object`

Generation behavior flags.

::callout{icon="i-heroicons-information-circle" color="blue"}
**Team-Scoped by Default:** All generated collections are team-scoped. The generator automatically adds `teamId` and `userId` fields and uses `@crouton/auth/server` for authentication. Do NOT define these fields in your schemas.
::

##### useMetadata

**Type:** `boolean`  
**Default:** `true`

Automatically add timestamp and audit fields:
- `createdAt` - Timestamp when record was created
- `updatedAt` - Timestamp when record was last modified
- `updatedBy` - User ID who last modified the record

```javascript
export default {
  flags: {
    useMetadata: true  // Add timestamps (default)
  }
}
```

::callout{icon="i-heroicons-exclamation-triangle" color="amber"}
When `useMetadata: true`, do NOT define `createdAt`, `updatedAt`, or `updatedBy` in your schemas.
::

##### autoRelations

**Type:** `boolean`  
**Default:** `false`

Add relation helper comments to generated schemas.

```javascript
export default {
  flags: {
    autoRelations: true
  }
}
```

##### noTranslations

**Type:** `boolean`  
**Default:** `false`

Skip translation field generation.

```javascript
export default {
  flags: {
    noTranslations: true  // Don't generate translation fields
  }
}
```

##### force

**Type:** `boolean`  
**Default:** `false`

Overwrite existing files without prompting.

```javascript
export default {
  flags: {
    force: true  // Overwrite files
  }
}
```

##### noDb

**Type:** `boolean`  
**Default:** `false`

Skip database table creation (generate code only).

```javascript
export default {
  flags: {
    noDb: true  // Skip database operations
  }
}
```

##### dryRun

**Type:** `boolean`  
**Default:** `false`

Preview what will be generated without creating files.

```javascript
export default {
  flags: {
    dryRun: true  // Preview only
  }
}
```

##### autoConnectors

**Type:** `boolean`  
**Default:** `false`

Auto-configure connectors without prompting (uses `connectors` config).

```javascript
export default {
  connectors: {
    users: {
      type: 'supersaas',
      autoInstall: true
    }
  },
  flags: {
    autoConnectors: true  // Don't prompt, use config above
  }
}
```

### Complete Configuration Example

```javascript
// crouton.config.js
export default {
  // Schema location
  schemaPath: './schemas/',

  // Database
  dialect: 'pg',

  // Target layers and collections
  targets: [
    {
      layer: 'shop',
      collections: ['products', 'categories', 'orders']
    },
    {
      layer: 'blog',
      collections: ['posts', 'authors', 'tags']
    }
  ],

  // External connectors
  connectors: {
    users: {
      type: 'supersaas',
      autoInstall: true,
      copyFiles: true,
      updateAppConfig: true
    }
  },

  // Generation flags
  flags: {
    // Timestamps
    useMetadata: true,

    // Relations
    autoRelations: false,

    // Translation fields
    noTranslations: false,

    // Database
    noDb: false,

    // Behavior
    force: false,
    dryRun: false,
    retries: 3,

    // Connectors
    autoConnectors: true
  }
}
```

## External References

When you reference collections outside your layer or from external systems, use the `:` prefix in `refTarget`:

```json
{
  "authorId": {
    "type": "string",
    "refTarget": ":users",  // External reference
    "meta": {
      "required": true
    }
  }
}
```

### Connector Detection Flow

1. **Generator scans schemas** for `:referenced` collections
2. **Checks config** for connector definitions
3. **Prompts interactively** (if `autoConnectors: false`) or **auto-configures** (if `autoConnectors: true`)
4. **Installs package** (if `autoInstall: true`)
5. **Copies files** to project (if `copyFiles: true`)
6. **Registers in app.config.ts** (if `updateAppConfig: true`)

### Interactive Connector Setup

Without `autoConnectors`, the generator prompts:

```bash
✓ Analyzed 5 schemas
⚠ Found external reference: :users (used in 3 collections)

Configure connector for 'users'? (Y/n)
> Y

Which auth system?
  1. SuperSaaS (team-based)
  2. Supabase (auth.users)
  3. Clerk
  4. Skip (configure manually)
> 1

✓ Installing @friendlyinternet/nuxt-crouton-supersaas
✓ Copied app/composables/useUsers.ts
✓ Copied server/api/teams/[id]/users/index.get.ts
✓ Updated app.config.ts
```

### Manual Connector Configuration

Skip automatic setup and configure manually:

```javascript
export default {
  connectors: {
    users: {
      type: 'supersaas',
      autoInstall: false,  // Don't install package
      copyFiles: false,     // Don't copy files
      updateAppConfig: false  // Don't update config
    }
  },
  flags: {
    autoConnectors: true  // Use config but don't auto-setup
  }
}
```

Then manually:
1. Install connector package
2. Copy/create connector files
3. Register in `app.config.ts`

## Common Workflows

### Create a New Project from Scratch

```bash
# 1. Create example schema
crouton-generate init

# 2. Edit schema file
# (Edit crouton-schema.json to match your needs)

# 3. Generate collection
crouton-generate shop products --fields-file=crouton-schema.json

# 4. Export schema in server/database/schema/index.ts
echo "export * from '~/layers/shop/collections/products/server/database/schema'" >> server/database/schema/index.ts

# 5. Run migrations and start dev server
pnpm dev
```

### Generate Multiple Collections

```bash
# 1. Create config file
cat > crouton.config.js << 'CONF'
export default {
  schemaPath: './schemas/',
  dialect: 'sqlite',
  targets: [
    {
      layer: 'shop',
      collections: ['products', 'categories', 'orders']
    }
  ],
  flags: {
    useMetadata: true,
    force: false
  }
}
CONF

# 2. Create schema files
mkdir -p schemas
# (Create products-schema.json, categories-schema.json, orders-schema.json)

# 3. Generate all at once
crouton-generate config

# 4. Export schemas
echo "export * from '~/layers/shop/collections/products/server/database/schema'" >> server/database/schema/index.ts
echo "export * from '~/layers/shop/collections/categories/server/database/schema'" >> server/database/schema/index.ts
echo "export * from '~/layers/shop/collections/orders/server/database/schema'" >> server/database/schema/index.ts
```

### Preview Changes Before Generating

```bash
# Use --dry-run to see what would be generated
crouton-generate shop products \
  --fields-file=schemas/product.json \
  --dry-run

# Output shows:
# - Files that would be created
# - Directories that would be created
# - Schemas that would be registered
```

### Safely Remove a Collection

```bash
# 1. Preview removal
crouton-generate rollback shop products --dry-run

# 2. Review what will be removed

# 3. Execute removal
crouton-generate rollback shop products

# 4. Remove schema export manually from server/database/schema/index.ts
```

### Clean Up an Entire Layer

```bash
# Use interactive mode for safety
crouton-generate rollback-interactive

# Select "Entire layer"
# Select the layer to remove
# Confirm removal
```

## Integration with Extraction Notes

The generator incorporates fixes and improvements documented in `/docs/extraction-notes.md`:

### Authorization Middleware

Generated API endpoints include team-based authorization by default:

```typescript
// Generated: server/api/teams/[id]/products/index.get.ts
import { resolveTeamAndCheckMembership } from '@friendlyinternet/nuxt-crouton-auth/server/utils/team'

export default defineEventHandler(async (event) => {
  const { team, user } = await resolveTeamAndCheckMembership(event)
  // team is automatically resolved and verified
  // All queries automatically scoped to team.id
  const products = await getProducts({ teamId: team.id })
  return products
})
```

::callout{icon="i-heroicons-information-circle" color="blue"}
**Note:** The auth package is automatically included when using `@friendlyinternet/nuxt-crouton`. You don't need to install it separately.
::

### Date Handling

All date fields use proper UTC storage and timezone handling:

```json
{
  "publishedAt": {
    "type": "date"
  }
}
```

Generated code includes:
- UTC storage in database
- Local timezone display in UI
- Proper date parsing and validation
- ISO 8601 format for portability

### Connector Integration

External references (`:users`, `:teams`) trigger automatic connector setup with proper type safety and composables.

## Troubleshooting

### Command Not Found

**Problem:** `crouton-generate: command not found`

**Solutions:**
```bash
# Option 1: Install globally
npm install -g @friendlyinternet/nuxt-crouton-cli

# Option 2: Use npx
npx @friendlyinternet/nuxt-crouton-cli <command>

# Option 3: Add to project and use npx
pnpm add -D @friendlyinternet/nuxt-crouton-cli
npx crouton-generate <command>
```

### Duplicate Key Errors

**Problem:** Build fails with duplicate key errors (e.g., `userId`, `teamId`)

**Cause:** You defined auto-generated fields in your schema

**Solution:** Remove auto-generated fields from schema:
- Remove `id` (always auto-generated)
- Remove `teamId`, `userId` (always auto-generated for team-scoped collections)
- Remove `createdAt`, `updatedAt`, `updatedBy` (when `useMetadata: true`)

### Config File Not Found

**Problem:** `Error: Config file not found: ./crouton.config.js`

**Solutions:**
```bash
# Use correct path
crouton-generate config ./path/to/config.js

# Or use --config flag
crouton-generate --config ./path/to/config.js

# Or ensure default location exists
ls crouton.config.js
```

### Schema File Not Found

**Problem:** `Error: Schema file not found`

**Solutions:**
```bash
# Use absolute path
crouton-generate shop products --fields-file=/full/path/to/schema.json

# Or use relative path from project root
crouton-generate shop products --fields-file=./schemas/product.json

# Verify file exists
ls ./schemas/product.json
```

### TypeScript Errors After Generation

**Problem:** Type errors in generated code

**Solutions:**
```bash
# 1. Ensure Nuxt Crouton is installed
pnpm add @friendlyinternet/nuxt-crouton

# 2. Run Nuxt prepare to regenerate types
npx nuxt prepare

# 3. Run typecheck
npx nuxt typecheck

# 4. Restart TypeScript server in your editor
```

### Rollback Doesn't Remove Everything

**Problem:** Some files remain after rollback

**Explanation:** Rollback only removes generated files, not manual modifications or schema exports.

**Manual cleanup needed:**
1. Remove schema exports from `server/database/schema/index.ts`
2. Remove any manual modifications to generated files
3. Remove database migrations if created

### Permission Errors

**Problem:** `EACCES: permission denied`

**Solutions:**
```bash
# Check file permissions
ls -la layers/

# Fix permissions
chmod -R u+w layers/

# Or run with sudo (not recommended)
sudo crouton-generate ...
```

## Best Practices

### Schema Design

1. **Start simple** - Add fields incrementally
2. **Use metadata** - Enable `useMetadata: true` for audit trails
3. **Reference external collections** - Use `:prefix` for external refs
4. **Validate in schema** - Use `meta.required`, `meta.maxLength`, etc.

### Configuration

1. **Use config files** for multi-collection projects
2. **Version control** your `crouton.config.js`
3. **Document connectors** in config comments
4. **Use `dryRun`** before actual generation

### Development Workflow

1. **Generate** collection
2. **Export schema** in `server/database/schema/index.ts`
3. **Run typecheck** (`npx nuxt typecheck`)
4. **Test** in dev mode
5. **Commit** generated files (they're your code now!)

### Rollback Strategy

1. **Always `--dry-run` first**
2. **Use interactive mode** for bulk operations
3. **Backup** before major rollbacks
4. **Clean manually** if needed

## Related Documentation

- [Generator Commands](/generation/cli-commands) - Overview of generation workflows
- [Schema Format](/generation/schema-format) - Complete schema reference
- [Multi-Collection](/generation/multi-collection) - Config-based generation
- [Team-Based Auth](/advanced/team-based-auth) - Multi-tenancy setup
- [Troubleshooting](/guides/troubleshooting) - Common issues and solutions

## Version History

- **v2.0.0** (Current) - Package renamed to `@friendlyinternet/nuxt-crouton-cli`
  - Package renamed from `nuxt-crouton-collection-generator`
  - Both `crouton` and `crouton-generate` commands available
  - Enhanced MCP server integration
  - All existing functionality preserved

- **v1.4.3** - Previous stable release
  - Enhanced rollback commands (single, bulk, interactive)
  - Improved connector detection and setup
  - Better error messages and validation
  - Date handling improvements
  - Authorization middleware generation

## Support

- **Issues:** [GitHub Issues](https://github.com/pmcp/nuxt-crouton/issues)
- **Package:** [@friendlyinternet/nuxt-crouton-cli](https://www.npmjs.com/package/@friendlyinternet/nuxt-crouton-cli)
- **Repository:** [nuxt-crouton](https://github.com/pmcp/nuxt-crouton)
