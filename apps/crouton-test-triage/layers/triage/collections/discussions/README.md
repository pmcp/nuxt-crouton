# TriageDiscussions Collection

> Generated by @fyit/crouton-cli on 2026-02-11

## Overview

| Property | Value |
|----------|-------|
| Collection Name | `triageDiscussions` |
| Layer | `triage` |
| API Base | `/api/teams/[teamId]/triage-discussions` |
| Form Component | `<TriageDiscussionsForm />` |
| List Component | `<TriageDiscussionsList />` |
| Composable | `useTriageDiscussions()` |

## Features

- References: flowInputId → inputs, syncJobId → jobs

## File Structure

```
collections/discussions/
├── app/
│   ├── components/
│   │   ├── Form.vue              # CRUD form with Zod validation
│   │   └── List.vue              # Data table with actions
│   └── composables/
│       └── useTriageDiscussions.ts   # Schema, columns, config
├── server/
│   ├── api/teams/[id]/triage-discussions/
│   │   ├── index.get.ts          # GET all / by IDs
│   │   ├── index.post.ts         # CREATE
│   │   ├── [discussionId].patch.ts    # UPDATE
│   │   └── [discussionId].delete.ts   # DELETE
│   └── database/
│       ├── schema.ts             # Drizzle ORM schema
│       └── queries.ts            # Database query functions
├── types.ts                      # TypeScript interfaces
├── nuxt.config.ts               # Layer configuration
└── README.md                    # This file
```

## Fields

| Field | Type | Required |
|-------|------|----------|
| id | string (primary key) | Auto |
| sourceType | string | Yes |
| sourceThreadId | string | Yes |
| sourceUrl | string | Yes |
| flowInputId | string (→ inputs) | Yes |
| title | string | Yes |
| content | text | Yes |
| authorHandle | string | Yes |
| participants | array | No |
| status | string | Yes |
| threadData | json | No |
| totalMessages | number | No |
| aiSummary | text | No |
| aiKeyPoints | array | No |
| aiTasks | json | No |
| isMultiTask | boolean | No |
| syncJobId | string (→ jobs) | No |
| notionTaskIds | array | No |
| rawPayload | json | No |
| metadata | json | No |
| processedAt | date | No |
| createdAt | timestamp | Auto |
| updatedAt | timestamp | Auto |
| createdBy | string | Auto |
| updatedBy | string | Auto |

## API Endpoints

### GET /api/teams/{teamId}/triage-discussions

Fetch all items or specific items by IDs.

```typescript
// Fetch all
const items = await $fetch(`/api/teams/${teamId}/triage-discussions`)

// Fetch by IDs
const items = await $fetch(`/api/teams/${teamId}/triage-discussions?ids=id1,id2,id3`)
```

### POST /api/teams/{teamId}/triage-discussions

Create a new item.

```typescript
const newItem = await $fetch(`/api/teams/${teamId}/triage-discussions`, {
  method: 'POST',
  body: {
    // ... fields (see schema)
  }
})
```

### PATCH /api/teams/{teamId}/triage-discussions/{discussionId}

Update an existing item.

```typescript
const updated = await $fetch(`/api/teams/${teamId}/triage-discussions/${discussionId}`, {
  method: 'PATCH',
  body: {
    // ... fields to update
  }
})
```

### DELETE /api/teams/{teamId}/triage-discussions/{discussionId}

Delete an item.

```typescript
await $fetch(`/api/teams/${teamId}/triage-discussions/${discussionId}`, {
  method: 'DELETE'
})
```

## Usage

### In Components

```vue
<script setup lang="ts">
// Query items
const { items: discussions, pending } = await useCollectionQuery('triageDiscussions')

// Mutations
const { create, update, deleteItems } = useCollectionMutation('triageDiscussions')
</script>

<template>
  <TriageDiscussionsList />
</template>
```

### Schema & Validation

```typescript
import { triageDiscussionSchema } from './app/composables/useTriageDiscussions'

// Validate data
const result = triageDiscussionSchema.safeParse(data)
```

## Customization Guide

### Add a New Field

1. Add field to your schema JSON file
2. Regenerate: `crouton config --only discussions`
3. Or manually:
   - Add to `types.ts` interface
   - Add to composable schema and defaultValues
   - Add `<UFormField>` in Form.vue
   - Add column in composable if needed

### Customize Form Layout

Edit `app/components/Form.vue`:
- Add field groups with `meta.group` in schema
- Modify `CroutonFormLayout` slots
- Add custom field components

### Add Custom Validation

Edit `app/composables/useTriageDiscussions.ts`:
```typescript
export const triageDiscussionSchema = z.object({
  // ... existing fields
  email: z.string().email('Invalid email'),
  age: z.number().min(0).max(120)
})
```

### Add Server-Side Logic

Edit API endpoints in `server/api/teams/[id]/triage-discussions/`:
- Add validation with `readValidatedBody`
- Add custom business logic
- Emit custom events/hooks

---

*This README was auto-generated. Safe to modify - regeneration requires --force flag.*
